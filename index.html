<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <script src="https://d3js.org/d3.v4.min.js"></script>
    <title>The Trumps</title>
    <style type="text/css">

.node circle {
  cursor: pointer;
  fill: #fff;
  stroke: steelblue;
  stroke-width: 1.5px;
}

.node text {
  font: 10px sans-serif;
}

path.link {
  fill: none;
  stroke: #ccc;
  stroke-width: 1.5px;
}

    </style>
  </head>
  <body>
<script type="text/javascript">
  d3.select(window).on('load', () => {
    const width = window.innerWidth * 0.9
    const height = window.innerHeight * 0.9
    const padding = 40;

    const svg = d3.select("body")
        .append("svg")
        .attr("width", width)
        .attr("height", height);

    const g = svg.append("g").attr("transform", "translate(" + width / 2 + "," + height / 2 + ") rotate(-90) " +
        "translate(" + (-height / 2 + padding) + "," + (-width / 2 + padding) +")")

    const tree = d3.cluster()
      .size([height - 2 * padding, width - 2 * padding])
      .separation(function(a, b) { return (a.parent == b.parent ? 1 : 2) / a.depth; });

    d3.json("trump_family.json", data => {
      const child = d => d.hasOwnProperty("children") ? d["children"] : d["partners"];
      const graph = d3.hierarchy(data, child);

      const root = tree(graph);
      const maxDepth = root.height;
      const nodeDepth = node => node.depth * ((width - 2 * padding) / maxDepth);

      var link = g.selectAll(".link")
        .data(root.links())
        .enter().append("path")
          .attr("class", "link")
          .attr("d", d3.linkVertical()
            .x(d => d.x)
            .y(nodeDepth))

      var node = g.selectAll(".node")
        .data(root.descendants())
        .enter().append("g")
          .attr("class", function(d) { return "node" + (d.children ? " node--internal" : " node--leaf"); })
          .attr("transform", d => {
            return "translate(" + (d.x) + "," + (nodeDepth(d)) + ")"
          });

      node.append("rect")
          .attr("width", 5)
          .attr("height", 5)

      node.append("text")
          .attr("dy", -15)
          .attr("x", d => d.children ? -8 : 8)
          .attr("text-anchor", function(d) { return d.children ? "start" : "end"; })
          .attr("transform", function(d) { return "rotate(90)"; })
          .text(function(d) { return d.data.name.substring(d.data.name.lastIndexOf(".") + 1); });
    });

});
</script>
  </body>
</html>
